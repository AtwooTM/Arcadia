<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Introduction to Arcadia
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Asynchronous Calculation Framework for MVVM Models">
    <meta name="author" content="David Carlson">

    <script src="http://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="http://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">

    <link type="text/css" rel="stylesheet" href="/Arcadia/content/style.css" />
    <script type="text/javascript" src="/Arcadia/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/mndrake/Arcadia">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/Arcadia/index.html">Arcadia</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1>Introduction to Arcadia</h1>

<p>Arcadia is an asynchronous calculation framework inspired by a discussion by Tobias Gedell on Eden <a href="http://www.youtube.com/watch?v=BsOtAXV_URI">YouTube video</a> and an 
article series by Daniel Earwicker on his Eventless library <a href="http://smellegantcode.wordpress.com/2013/02/25/eventless-programming-part-1-why-the-heck/">link</a>.</p>

<p>The main points of Eden that stuck with me were :</p>

<ol>
<li>Laziness and partial recalc</li>
<li>Caching</li>
<li>Asynchronous result production</li>
<li>Automatic parallelization</li>
<li>Optional manual calculation</li>
<li>Cancellation</li>
</ol>

<p>Currently I have implemented the above plus basic error handling (changes the node with error to an Error status, no logging of error currently.)</p>

<p><strong>TO DO LIST</strong><br />
logging<br />
redo/undo<br />
serialization/persistense of <code>CalculationEngine</code> to database</p>

<p>Arcadia is implemented using .Net generics so calculation "nodes" do not need to implement just a single numberic value.  Inputs/Outputs can be any POCO/recordset/struct that you want.</p>

<h1>Node Dependency Graph</h1>

<p>Here is a dependency graph with input nodes (green) and output nodes (blue).  We will use this as an illustration of the dependency tree that we will now try to replicate using simple integer based nodes.</p>

<img src="img/NodeGraph.png" height="300" width="600" />

<h1>F# Example - simple integers</h1>

<p>First lets define some simple functions to represent some slow running functions.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Threading</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">add2</span> (<span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">x1</span>,<span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="i">x2</span>) <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">Thread</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="i">Sleep</span> <span class="n">500</span>
    <span onmouseout="hideTip(event, 'fs4', 8)" onmouseover="showTip(event, 'fs4', 8)" class="i">x1</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs5', 9)" onmouseover="showTip(event, 'fs5', 9)" class="i">x2</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="i">add3</span> (<span onmouseout="hideTip(event, 'fs9', 11)" onmouseover="showTip(event, 'fs9', 11)" class="i">x1</span>,<span onmouseout="hideTip(event, 'fs10', 12)" onmouseover="showTip(event, 'fs10', 12)" class="i">x2</span>,<span onmouseout="hideTip(event, 'fs11', 13)" onmouseover="showTip(event, 'fs11', 13)" class="i">x3</span>) <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs6', 14)" onmouseover="showTip(event, 'fs6', 14)" class="i">Thread</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 15)" onmouseover="showTip(event, 'fs7', 15)" class="i">Sleep</span> <span class="n">1000</span>
    <span onmouseout="hideTip(event, 'fs9', 16)" onmouseover="showTip(event, 'fs9', 16)" class="i">x1</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs10', 17)" onmouseover="showTip(event, 'fs10', 17)" class="i">x2</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs11', 18)" onmouseover="showTip(event, 'fs11', 18)" class="i">x3</span></pre>
</td>
</tr>
</table>

<p>Now lets create a calculation engine that does simple addition at nodes based on the dependency graph we saw earlier. An optional custom ID can be assigned to a node.
If no node ID is given then <code>Setables</code> will be named in0, in1, in2, ... and <code>Getables</code> will be named out0, out1, out2, ...<br />
For F# there is an additional operator that allows in0.Value to be replaced with !!in0.  For C# there is an implicit coversion of <code>Getable&lt;T&gt; in0</code> to <code>T in0.Value</code>.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs12', 19)" onmouseover="showTip(event, 'fs12', 19)" class="i">Arcadia</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs12', 20)" onmouseover="showTip(event, 'fs12', 20)" class="i">Arcadia</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 21)" onmouseover="showTip(event, 'fs13', 21)" class="i">FSharp</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs14', 22)" onmouseover="showTip(event, 'fs14', 22)" class="i">SimpleCalculationEngine</span>() <span class="k">as</span> <span onmouseout="hideTip(event, 'fs15', 23)" onmouseover="showTip(event, 'fs15', 23)" class="i">x</span> <span class="o">=</span>
    <span class="k">inherit</span> <span onmouseout="hideTip(event, 'fs16', 24)" onmouseover="showTip(event, 'fs16', 24)" class="i">CalculationEngine</span>()

    <span class="k">do</span>        
        <span class="c">// input nodes</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs17', 25)" onmouseover="showTip(event, 'fs17', 25)" class="i">in0</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 26)" onmouseover="showTip(event, 'fs15', 26)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 27)" onmouseover="showTip(event, 'fs18', 27)" class="i">Setable</span> <span class="n">1</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs19', 28)" onmouseover="showTip(event, 'fs19', 28)" class="i">in1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 29)" onmouseover="showTip(event, 'fs15', 29)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 30)" onmouseover="showTip(event, 'fs18', 30)" class="i">Setable</span> <span class="n">1</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs20', 31)" onmouseover="showTip(event, 'fs20', 31)" class="i">in2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 32)" onmouseover="showTip(event, 'fs15', 32)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 33)" onmouseover="showTip(event, 'fs18', 33)" class="i">Setable</span> <span class="n">1</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs21', 34)" onmouseover="showTip(event, 'fs21', 34)" class="i">in3</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 35)" onmouseover="showTip(event, 'fs15', 35)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 36)" onmouseover="showTip(event, 'fs18', 36)" class="i">Setable</span> <span class="n">1</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs22', 37)" onmouseover="showTip(event, 'fs22', 37)" class="i">in4</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 38)" onmouseover="showTip(event, 'fs15', 38)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 39)" onmouseover="showTip(event, 'fs18', 39)" class="i">Setable</span> <span class="n">1</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 40)" onmouseover="showTip(event, 'fs23', 40)" class="i">in5</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 41)" onmouseover="showTip(event, 'fs15', 41)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 42)" onmouseover="showTip(event, 'fs18', 42)" class="i">Setable</span> <span class="n">1</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 43)" onmouseover="showTip(event, 'fs24', 43)" class="i">in6</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 44)" onmouseover="showTip(event, 'fs15', 44)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 45)" onmouseover="showTip(event, 'fs18', 45)" class="i">Setable</span> <span class="n">1</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 46)" onmouseover="showTip(event, 'fs25', 46)" class="i">in7</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 47)" onmouseover="showTip(event, 'fs15', 47)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 48)" onmouseover="showTip(event, 'fs18', 48)" class="i">Setable</span> <span class="n">1</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs26', 49)" onmouseover="showTip(event, 'fs26', 49)" class="i">in8</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 50)" onmouseover="showTip(event, 'fs15', 50)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 51)" onmouseover="showTip(event, 'fs18', 51)" class="i">Setable</span> <span class="n">1</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs27', 52)" onmouseover="showTip(event, 'fs27', 52)" class="i">in9</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 53)" onmouseover="showTip(event, 'fs15', 53)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 54)" onmouseover="showTip(event, 'fs18', 54)" class="i">Setable</span> <span class="n">1</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs28', 55)" onmouseover="showTip(event, 'fs28', 55)" class="i">in10</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 56)" onmouseover="showTip(event, 'fs15', 56)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 57)" onmouseover="showTip(event, 'fs18', 57)" class="i">Setable</span> <span class="n">1</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs29', 58)" onmouseover="showTip(event, 'fs29', 58)" class="i">in11</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 59)" onmouseover="showTip(event, 'fs15', 59)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 60)" onmouseover="showTip(event, 'fs18', 60)" class="i">Setable</span> <span class="n">1</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs30', 61)" onmouseover="showTip(event, 'fs30', 61)" class="i">in12</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 62)" onmouseover="showTip(event, 'fs15', 62)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 63)" onmouseover="showTip(event, 'fs18', 63)" class="i">Setable</span> <span class="n">1</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs31', 64)" onmouseover="showTip(event, 'fs31', 64)" class="i">in13</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 65)" onmouseover="showTip(event, 'fs15', 65)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 66)" onmouseover="showTip(event, 'fs18', 66)" class="i">Setable</span> <span class="n">1</span>

        <span class="c">// main calculation chain</span>
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs32', 67)" onmouseover="showTip(event, 'fs32', 67)" class="i">out0</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 68)" onmouseover="showTip(event, 'fs15', 68)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 69)" onmouseover="showTip(event, 'fs33', 69)" class="i">Computed</span>(<span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 70)" onmouseover="showTip(event, 'fs3', 70)" class="i">add2</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs17', 71)" onmouseover="showTip(event, 'fs17', 71)" class="i">in0</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs19', 72)" onmouseover="showTip(event, 'fs19', 72)" class="i">in1</span>)
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs34', 73)" onmouseover="showTip(event, 'fs34', 73)" class="i">out1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 74)" onmouseover="showTip(event, 'fs15', 74)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 75)" onmouseover="showTip(event, 'fs33', 75)" class="i">Computed</span>(<span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 76)" onmouseover="showTip(event, 'fs3', 76)" class="i">add2</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs20', 77)" onmouseover="showTip(event, 'fs20', 77)" class="i">in2</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs21', 78)" onmouseover="showTip(event, 'fs21', 78)" class="i">in3</span>)
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs35', 79)" onmouseover="showTip(event, 'fs35', 79)" class="i">out2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 80)" onmouseover="showTip(event, 'fs15', 80)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 81)" onmouseover="showTip(event, 'fs33', 81)" class="i">Computed</span>(<span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs8', 82)" onmouseover="showTip(event, 'fs8', 82)" class="i">add3</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs22', 83)" onmouseover="showTip(event, 'fs22', 83)" class="i">in4</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs23', 84)" onmouseover="showTip(event, 'fs23', 84)" class="i">in5</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs24', 85)" onmouseover="showTip(event, 'fs24', 85)" class="i">in6</span>)
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 86)" onmouseover="showTip(event, 'fs36', 86)" class="i">out3</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 87)" onmouseover="showTip(event, 'fs15', 87)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 88)" onmouseover="showTip(event, 'fs33', 88)" class="i">Computed</span>(<span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 89)" onmouseover="showTip(event, 'fs3', 89)" class="i">add2</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs25', 90)" onmouseover="showTip(event, 'fs25', 90)" class="i">in7</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs26', 91)" onmouseover="showTip(event, 'fs26', 91)" class="i">in8</span>)
        <span class="k">let</span> <span class="i">out4</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 92)" onmouseover="showTip(event, 'fs15', 92)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 93)" onmouseover="showTip(event, 'fs33', 93)" class="i">Computed</span>(<span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 94)" onmouseover="showTip(event, 'fs3', 94)" class="i">add2</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs34', 95)" onmouseover="showTip(event, 'fs34', 95)" class="i">out1</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs35', 96)" onmouseover="showTip(event, 'fs35', 96)" class="i">out2</span>)
        <span class="k">let</span> <span class="i">out5</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 97)" onmouseover="showTip(event, 'fs15', 97)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 98)" onmouseover="showTip(event, 'fs33', 98)" class="i">Computed</span>(<span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 99)" onmouseover="showTip(event, 'fs3', 99)" class="i">add2</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs32', 100)" onmouseover="showTip(event, 'fs32', 100)" class="i">out0</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs36', 101)" onmouseover="showTip(event, 'fs36', 101)" class="i">out3</span>)
        <span class="k">let</span> <span class="i">out6</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 102)" onmouseover="showTip(event, 'fs15', 102)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 103)" onmouseover="showTip(event, 'fs33', 103)" class="i">Computed</span>(<span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 104)" onmouseover="showTip(event, 'fs3', 104)" class="i">add2</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs27', 105)" onmouseover="showTip(event, 'fs27', 105)" class="i">in9</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs28', 106)" onmouseover="showTip(event, 'fs28', 106)" class="i">in10</span>)
        <span class="k">let</span> <span class="i">out7</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 107)" onmouseover="showTip(event, 'fs15', 107)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 108)" onmouseover="showTip(event, 'fs33', 108)" class="i">Computed</span>(<span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 109)" onmouseover="showTip(event, 'fs3', 109)" class="i">add2</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs29', 110)" onmouseover="showTip(event, 'fs29', 110)" class="i">in11</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs30', 111)" onmouseover="showTip(event, 'fs30', 111)" class="i">in12</span>)
        <span class="k">let</span> <span class="i">out8</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 112)" onmouseover="showTip(event, 'fs15', 112)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 113)" onmouseover="showTip(event, 'fs33', 113)" class="i">Computed</span>(<span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 114)" onmouseover="showTip(event, 'fs3', 114)" class="i">add2</span> <span class="o">!!</span><span class="i">out4</span> <span class="o">!!</span><span class="i">out6</span>)
        <span class="k">let</span> <span class="i">out9</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 115)" onmouseover="showTip(event, 'fs15', 115)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 116)" onmouseover="showTip(event, 'fs33', 116)" class="i">Computed</span>(<span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs8', 117)" onmouseover="showTip(event, 'fs8', 117)" class="i">add3</span> <span class="o">!!</span><span class="i">out5</span> <span class="o">!!</span><span class="i">out7</span> <span class="o">!!</span><span class="i">out8</span>)

        <span class="c">// secondary calculation chain</span>
        <span class="k">let</span> <span class="i">out10</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 118)" onmouseover="showTip(event, 'fs15', 118)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 119)" onmouseover="showTip(event, 'fs33', 119)" class="i">Computed</span>(<span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 120)" onmouseover="showTip(event, 'fs3', 120)" class="i">add2</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs32', 121)" onmouseover="showTip(event, 'fs32', 121)" class="i">out0</span> <span class="o">!!</span><span class="i">out5</span>)
        <span class="k">let</span> <span class="i">out11</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs15', 122)" onmouseover="showTip(event, 'fs15', 122)" class="i">x</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 123)" onmouseover="showTip(event, 'fs33', 123)" class="i">Computed</span>(<span class="k">fun</span> () <span class="k">-&gt;</span> <span class="o">!!</span><span onmouseout="hideTip(event, 'fs31', 124)" onmouseover="showTip(event, 'fs31', 124)" class="i">in13</span>)</pre>
</td>
</tr>
</table>

<h2>Test out our Calculation Engine</h2>

<p>Create an instance of the calculation engine and turn on automatic calculations. 
Run the following a statement at a time and see how it works.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs37', 125)" onmouseover="showTip(event, 'fs37', 125)" class="i">ce</span> <span class="o">=</span> <span class="i">SimpleCalcEngine</span>()

<span class="c">/// print out the status and value of a given node.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs38', 126)" onmouseover="showTip(event, 'fs38', 126)" class="i">nodeValue</span>(<span onmouseout="hideTip(event, 'fs39', 127)" onmouseover="showTip(event, 'fs39', 127)" class="i">nodeId</span>) <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs40', 128)" onmouseover="showTip(event, 'fs40', 128)" class="i">n</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs37', 129)" onmouseover="showTip(event, 'fs37', 129)" class="i">ce</span><span class="o">.</span><span class="i">Node</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs41', 130)" onmouseover="showTip(event, 'fs41', 130)" class="i">int</span><span class="o">&gt;</span>(<span onmouseout="hideTip(event, 'fs39', 131)" onmouseover="showTip(event, 'fs39', 131)" class="i">nodeId</span>)
    <span onmouseout="hideTip(event, 'fs42', 132)" onmouseover="showTip(event, 'fs42', 132)" class="i">printfn</span> <span class="s">&quot;</span><span class="s">%</span><span class="s">s</span><span class="s"> </span><span class="s">status</span><span class="s">:</span><span class="s">%</span><span class="s">A</span><span class="s"> </span><span class="s">value</span><span class="s">:</span><span class="s">%</span><span class="s">i</span><span class="s">&quot;</span> (<span onmouseout="hideTip(event, 'fs40', 133)" onmouseover="showTip(event, 'fs40', 133)" class="i">n</span><span class="o">.</span><span class="i">Id</span>) (<span onmouseout="hideTip(event, 'fs40', 134)" onmouseover="showTip(event, 'fs40', 134)" class="i">n</span><span class="o">.</span><span class="i">Status</span>) (<span onmouseout="hideTip(event, 'fs40', 135)" onmouseover="showTip(event, 'fs40', 135)" class="i">n</span><span class="o">.</span><span class="i">Value</span>)

<span onmouseout="hideTip(event, 'fs38', 136)" onmouseover="showTip(event, 'fs38', 136)" class="i">nodeValue</span> <span class="s">&quot;</span><span class="s">out9</span><span class="s">&quot;</span> <span class="c">// returns &quot;out9 status:Dirty value:0&quot;</span>

<span onmouseout="hideTip(event, 'fs37', 137)" onmouseover="showTip(event, 'fs37', 137)" class="i">ce</span><span class="o">.</span><span class="i">Calculation</span><span class="o">.</span><span class="i">Automatic</span> <span class="o">&lt;-</span> <span class="k">true</span>

<span class="c">// check again (will need to wait a few seconds while calculations complete)</span>
<span onmouseout="hideTip(event, 'fs38', 138)" onmouseover="showTip(event, 'fs38', 138)" class="i">nodeValue</span> <span class="s">&quot;</span><span class="s">out9</span><span class="s">&quot;</span> <span class="c">// returns &quot;out9 status:Valid value:13&quot;</span></pre>
</td>
</tr>
</table>

<p>You can also do manual calculations if you didn't want to have everything calculating automatically.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// set calculations back to manual</span>
<span onmouseout="hideTip(event, 'fs37', 139)" onmouseover="showTip(event, 'fs37', 139)" class="i">ce</span><span class="o">.</span><span class="i">Calculation</span><span class="o">.</span><span class="i">Automatic</span> <span class="o">&lt;-</span> <span class="k">false</span>

<span class="c">// set the value of in1 to 3 </span>
<span onmouseout="hideTip(event, 'fs37', 140)" onmouseover="showTip(event, 'fs37', 140)" class="i">ce</span><span class="o">.</span><span class="i">Node</span>(<span class="s">&quot;</span><span class="s">in1</span><span class="s">&quot;</span>)<span class="o">.</span><span class="i">Value</span> <span class="o">&lt;-</span> <span class="n">3</span>

<span class="c">// check the value of nodes dependent on in1</span>
<span onmouseout="hideTip(event, 'fs38', 141)" onmouseover="showTip(event, 'fs38', 141)" class="i">nodeValue</span> <span class="s">&quot;</span><span class="s">out9</span><span class="s">&quot;</span> <span class="c">// returns out9 status: Dirty value:13</span>
<span onmouseout="hideTip(event, 'fs38', 142)" onmouseover="showTip(event, 'fs38', 142)" class="i">nodeValue</span> <span class="s">&quot;</span><span class="s">out10</span><span class="s">&quot;</span> <span class="c">// returns out10 status: Dirty value: 6</span>

<span class="c">// if we want to get the updated value we can request an update</span>
<span onmouseout="hideTip(event, 'fs37', 143)" onmouseover="showTip(event, 'fs37', 143)" class="i">ce</span><span class="o">.</span><span class="i">Node</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs41', 144)" onmouseover="showTip(event, 'fs41', 144)" class="i">int</span><span class="o">&gt;</span>(<span class="s">&quot;</span><span class="s">out9</span><span class="s">&quot;</span>)<span class="o">.</span><span class="i">AsyncCalculate</span>()

<span class="c">// wait a couple of seconds (or not and see a Dirty result for out9)</span>
<span onmouseout="hideTip(event, 'fs38', 145)" onmouseover="showTip(event, 'fs38', 145)" class="i">nodeValue</span> <span class="s">&quot;</span><span class="s">out9</span><span class="s">&quot;</span> <span class="c">// returns out9 status: Valid value:15</span>
<span onmouseout="hideTip(event, 'fs38', 146)" onmouseover="showTip(event, 'fs38', 146)" class="i">nodeValue</span> <span class="s">&quot;</span><span class="s">out10</span><span class="s">&quot;</span> <span class="c">// returns out10 status: Dirty value: 6</span></pre>
</td>
</tr>
</table>

<p>Since out9 does not depend on out10 it did not recalculate (point 1 from our starting list).</p>

<p><a href="csharp_simple.html">Here</a> is the above example implemented in C#.</p>

<p>An example of how this can be implemented in an MVVM application can be found on the GitHub site in the src/Samples folder.</p>

<div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace System.Threading</div>
<div class="tip" id="fs3">val add2 : x1:obj * x2:obj -&gt; (int -&gt; obj * obj)<br /><br />Full name: Introduction.add2</div>
<div class="tip" id="fs4">val x1 : obj</div>
<div class="tip" id="fs5">val x2 : obj</div>
<div class="tip" id="fs6">Multiple items<br />type Thread =<br />&#160;&#160;inherit CriticalFinalizerObject<br />&#160;&#160;new : start:ThreadStart -&gt; Thread + 3 overloads<br />&#160;&#160;member Abort : unit -&gt; unit + 1 overload<br />&#160;&#160;member ApartmentState : ApartmentState with get, set<br />&#160;&#160;member CurrentCulture : CultureInfo with get, set<br />&#160;&#160;member CurrentUICulture : CultureInfo with get, set<br />&#160;&#160;member DisableComObjectEagerCleanup : unit -&gt; unit<br />&#160;&#160;member ExecutionContext : ExecutionContext<br />&#160;&#160;member GetApartmentState : unit -&gt; ApartmentState<br />&#160;&#160;member GetCompressedStack : unit -&gt; CompressedStack<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;...<br /><br />Full name: System.Threading.Thread<br /><br />--------------------<br />Thread(start: ThreadStart) : unit<br />Thread(start: ParameterizedThreadStart) : unit<br />Thread(start: ThreadStart, maxStackSize: int) : unit<br />Thread(start: ParameterizedThreadStart, maxStackSize: int) : unit</div>
<div class="tip" id="fs7">Thread.Sleep(timeout: System.TimeSpan) : unit<br />Thread.Sleep(millisecondsTimeout: int) : unit</div>
<div class="tip" id="fs8">val add3 : x1:&#39;a * x2:&#39;b * x3:&#39;d -&gt; (int -&gt; int -&gt; int) (requires member ( + ) and member ( + ))<br /><br />Full name: Introduction.add3</div>
<div class="tip" id="fs9">val x1 : &#39;a (requires member ( + ) and member ( + ))</div>
<div class="tip" id="fs10">val x2 : &#39;a (requires member ( + ) and member ( + ))</div>
<div class="tip" id="fs11">val x3 : &#39;a (requires member ( + ) and member ( + ))</div>
<div class="tip" id="fs12">namespace Arcadia</div>
<div class="tip" id="fs13">module FSharp<br /><br />from Arcadia</div>
<div class="tip" id="fs14">Multiple items<br />type SimpleCalculationEngine =<br />&#160;&#160;inherit CalculationEngine<br />&#160;&#160;new : unit -&gt; SimpleCalculationEngine<br /><br />Full name: Introduction.SimpleCalculationEngine<br /><br />--------------------<br />new : unit -&gt; SimpleCalculationEngine</div>
<div class="tip" id="fs15">val x : SimpleCalculationEngine</div>
<div class="tip" id="fs16">Multiple items<br />type CalculationEngine =<br />&#160;&#160;interface ICalculationEngine<br />&#160;&#160;new : unit -&gt; CalculationEngine<br />&#160;&#160;new : calculationHandler:ICalculationHandler -&gt; CalculationEngine<br />&#160;&#160;member Computed : nodeFunction:Func&lt;&#39;U&gt; -&gt; Computed&lt;&#39;U&gt;<br />&#160;&#160;member Computed : nodeFunction:Func&lt;&#39;U&gt; * throttle:int -&gt; Computed&lt;&#39;U&gt;<br />&#160;&#160;member Computed : nodeFunction:Func&lt;&#39;U&gt; * nodeId:string -&gt; Computed&lt;&#39;U&gt;<br />&#160;&#160;member Computed : nodeFunction:Func&lt;&#39;U&gt; * nodeId:string * throttle:int -&gt; Computed&lt;&#39;U&gt;<br />&#160;&#160;member Node : nodeId:string -&gt; INode&lt;&#39;U&gt;<br />&#160;&#160;member Setable : value:&#39;U -&gt; Setable&lt;&#39;U&gt;<br />&#160;&#160;member Setable : value:&#39;U * nodeId:string -&gt; Setable&lt;&#39;U&gt;<br />&#160;&#160;...<br /><br />Full name: Arcadia.CalculationEngine<br /><br />--------------------<br />new : unit -&gt; CalculationEngine<br />new : calculationHandler:ICalculationHandler -&gt; CalculationEngine</div>
<div class="tip" id="fs17">val in0 : Setable&lt;int&gt;</div>
<div class="tip" id="fs18">member CalculationEngine.Setable : value:&#39;U -&gt; Setable&lt;&#39;U&gt;<br />member CalculationEngine.Setable : value:&#39;U * nodeId:string -&gt; Setable&lt;&#39;U&gt;</div>
<div class="tip" id="fs19">val in1 : Setable&lt;int&gt;</div>
<div class="tip" id="fs20">val in2 : Setable&lt;int&gt;</div>
<div class="tip" id="fs21">val in3 : Setable&lt;int&gt;</div>
<div class="tip" id="fs22">val in4 : Setable&lt;int&gt;</div>
<div class="tip" id="fs23">val in5 : Setable&lt;int&gt;</div>
<div class="tip" id="fs24">val in6 : Setable&lt;int&gt;</div>
<div class="tip" id="fs25">val in7 : Setable&lt;int&gt;</div>
<div class="tip" id="fs26">val in8 : Setable&lt;int&gt;</div>
<div class="tip" id="fs27">val in9 : Setable&lt;int&gt;</div>
<div class="tip" id="fs28">val in10 : Setable&lt;int&gt;</div>
<div class="tip" id="fs29">val in11 : Setable&lt;int&gt;</div>
<div class="tip" id="fs30">val in12 : Setable&lt;int&gt;</div>
<div class="tip" id="fs31">val in13 : Setable&lt;int&gt;</div>
<div class="tip" id="fs32">val out0 : Computed&lt;obj * obj&gt;</div>
<div class="tip" id="fs33">member CalculationEngine.Computed : nodeFunction:System.Func&lt;&#39;U&gt; -&gt; Computed&lt;&#39;U&gt;<br />member CalculationEngine.Computed : nodeFunction:System.Func&lt;&#39;U&gt; * throttle:int -&gt; Computed&lt;&#39;U&gt;<br />member CalculationEngine.Computed : nodeFunction:System.Func&lt;&#39;U&gt; * nodeId:string -&gt; Computed&lt;&#39;U&gt;<br />member CalculationEngine.Computed : nodeFunction:System.Func&lt;&#39;U&gt; * nodeId:string * throttle:int -&gt; Computed&lt;&#39;U&gt;</div>
<div class="tip" id="fs34">val out1 : Computed&lt;obj * obj&gt;</div>
<div class="tip" id="fs35">val out2 : Computed&lt;int&gt;</div>
<div class="tip" id="fs36">val out3 : Computed&lt;obj * obj&gt;</div>
<div class="tip" id="fs37">val ce : &#39;a<br /><br />Full name: Introduction.ce</div>
<div class="tip" id="fs38">val nodeValue : nodeId:&#39;a -&gt; unit<br /><br />Full name: Introduction.nodeValue<br /><em><br /><br />&#160;print out the status and value of a given node.</em></div>
<div class="tip" id="fs39">val nodeId : &#39;a</div>
<div class="tip" id="fs40">val n : &#39;a</div>
<div class="tip" id="fs41">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;</div>
<div class="tip" id="fs42">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>

        </div>
        <div class="span3">
          <ul class="nav nav-list" id="menu">
            <li class="nav-header">Arcadia</li>
            <li><a href="/Arcadia/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://nuget.org/packages/Arcadia">Get Library via NuGet</a></li>
            <li><a href="http://github.com/mndrake/Arcadia">Source Code on GitHub</a></li>
            <li><a href="http://github.com/mndrake/Arcadia/blob/master/LICENSE.txt">License</a></li>
            <li><a href="http://github.com/mndrake/Arcadia/blob/master/RELEASE_NOTES.md">Release Notes</a></li>
            
            <li class="nav-header">Getting started</li>
            <li><a href="/Arcadia/introduction.html">Introduction</a></li>

            <li><a href="/Arcadia/csharp_example.html">C# sample</a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="/Arcadia/reference/index.html">API Reference</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/mndrake/Arcadia"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>
  </body>
  </html>
